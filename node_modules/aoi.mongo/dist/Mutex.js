"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.Mutex = void 0;
/** Mutex for locker utility */
class Mutex {
    constructor() {
        this._locked = false;
        this._queue = [];
    }
    /** Lock the mutex */
    lock() {
        const promise = new Promise(resolve => this._queue.push(resolve));
        if (!this._locked) {
            this._locked = true;
            this.unlock();
        }
        return promise;
    }
    /** Unlock the mutex */
    unlock() {
        const next = this._queue.shift();
        if (!next) {
            if (this._locked)
                this._locked = false;
            return;
        }
        next();
    }
}
exports.Mutex = Mutex;
